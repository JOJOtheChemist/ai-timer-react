# 首页（MainSchedulePage）业务域-文件映射表

| 首页核心功能                                        | 对应业务域 | 后端文件路径                              | 核心函数/接口说明                                                                                                                                                                                               |
| --------------------------------------------------- | ---------- | ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1. 高频任务库（增删改查、分类筛选、子任务展开）     | task       | api/v1/endpoints/task/tasks.py            | - GET /api/v1/tasks：获取任务列表（支持按类型筛选，如“学习/生活”）`<br>`- POST /api/v1/tasks：新增任务`<br>`- PATCH /api/v1/tasks/{task_id}：更新任务（如展开/收起子任务）                                |
|                                                     | task       | services/task/task_service.py             | - get_task_list(user_id, category)：按分类查询用户任务`<br>`- create_task(user_id, task_data)：创建任务`<br>`- update_task_expand_status(user_id, task_id, is_expand)：更新任务展开状态                     |
|                                                     | task       | crud/task/crud_task.py                    | - get_multi_by_category(db, user_id, category)：按分类查数据库任务`<br>`- create(db, user_id, task_data)：保存任务到数据库`<br>`- update_expand_status(db, task_id, is_expand)：更新任务展开状态            |
|                                                     | task       | models/schemas/task.py                    | - TaskCreate：新增任务的请求参数模型（name、type、category等）`<br>`- TaskResponse：任务列表的响应参数模型（含子任务、weeklyHours等）                                                                         |
| 2. 今日时间表（时段任务展示、心情记录、AI推荐任务） | schedule   | api/v1/endpoints/schedule/time_slots.py   | - GET /api/v1/schedule/time-slots：获取今日时段任务列表`<br>`- POST /api/v1/schedule/time-slots/{slot_id}/mood：提交时段心情记录`<br>`- POST /api/v1/schedule/time-slots/{slot_id}/task：为空白时段添加任务 |
|                                                     | schedule   | services/schedule/time_slot_service.py    | - get_today_time_slots(user_id)：查询用户今日所有时段任务`<br>`- save_mood_record(user_id, slot_id, mood)：保存时段心情`<br>`- add_task_to_slot(user_id, slot_id, task_id)：为时段绑定任务                  |
|                                                     | schedule   | crud/schedule/crud_time_slot.py           | - get_today_by_user(db, user_id)：查用户今日时段数据`<br>`- create_mood_record(db, user_id, slot_id, mood)：保存心情到数据库`<br>`- update_slot_task(db, slot_id, task_id)：更新时段绑定的任务              |
|                                                     | schedule   | models/schemas/schedule.py                | - TimeSlotResponse：时段任务的响应模型（含time、task、status、mood等）`<br>`- MoodCreate：心情记录的请求模型（slot_id、mood）                                                                                 |
| 3. 本周统计概览（总时长、完成率、图表数据）         | statistic  | api/v1/endpoints/statistic/statistics.py  | - GET /api/v1/statistic/weekly-overview：获取本周统计概览（总时长、完成率等）`<br>`- GET /api/v1/statistic/weekly-chart：获取本周时间分布图表数据（柱状图、环形图）                                           |
|                                                     | statistic  | services/statistic/statistic_service.py   | - calculate_weekly_overview(user_id)：计算本周核心统计数据`<br>`- generate_weekly_chart_data(user_id)：生成本周图表所需数据（按天/按类别聚合时长）                                                            |
|                                                     | statistic  | crud/statistic/crud_statistic.py          | - get_weekly_task_hours(db, user_id)：查用户本周各任务时长`<br>`- get_weekly_category_hours(db, user_id)：查用户本周各类型任务总时长                                                                          |
|                                                     | statistic  | models/schemas/statistic.py               | - WeeklyOverviewResponse：本周概览响应模型（总学习时长、高频任务完成率等）`<br>`- WeeklyChartResponse：图表数据响应模型（labels、datasets）                                                                   |
| 4. AI推荐（时段任务建议、效率优化建议）             | ai         | api/v1/endpoints/ai/ai_recommendations.py | - GET /api/v1/ai/schedule-recommendations：获取时间表AI推荐任务`<br>`- POST /api/v1/ai/schedule-recommendations/{rec_id}/accept：采纳AI推荐`<br>`- GET /api/v1/ai/efficiency-tips：获取效率优化建议         |
|                                                     | ai         | services/ai/ai_service.py                 | - generate_schedule_recommendation(user_id)：基于用户习惯生成时段任务推荐`<br>`- handle_recommendation_accept(user_id, rec_id)：处理推荐采纳逻辑`<br>`- generate_efficiency_tips(user_id)：生成效率优化建议 |
|                                                     | ai         | crud/ai/crud_ai_recommendation.py         | - create_recommendation(db, user_id, rec_data)：保存AI推荐记录`<br>`- update_recommendation_status(db, rec_id, is_accepted)：更新推荐采纳状态                                                                 |
|                                                     | ai         | models/schemas/ai.py                      | - AIRecommendationResponse：AI推荐的响应模型（含aiTip、isAIRecommended等）`<br>`- EfficiencyTipResponse：效率建议的响应模型（tips列表）                                                                       |
| 5. 快捷输入添加任务                                 | task       | api/v1/endpoints/task/tasks.py            | - POST /api/v1/tasks/quick-add：快捷新增任务（无需填写完整参数，快速创建）                                                                                                                                      |
|                                                     | task       | services/task/task_service.py             | - quick_create_task(user_id, task_name)：快捷创建任务（自动补全默认类型、时长等）                                                                                                                               |
| 6. 用户身份校验（顶部导航用户信息、数据归属）       | user       | core/dependencies.py                      | - get_current_user：依赖注入函数，从Token中解析当前用户ID，确保数据归属正确                                                                                                                                     |
|                                                     | user       | services/user/user_auth_service.py        | - verify_token(token)：验证用户Token有效性，获取用户ID                                                                                                                                                          |
|                                                     | user       | core/security.py                          | - create_access_token(user_id)：生成用户登录Token`<br>`- verify_password(plain_password, hashed_password)：验证密码（间接支撑登录态）                                                                         |

### 说明

1. 首页功能跨多个业务域，但每个功能都对应到“单一业务域”的文件，避免代码分散；
2. 所有用户相关的“数据权限校验”（如确保查的是当前用户的任务/时间表），统一通过 `user`业务域的 `get_current_user`依赖实现，无需在其他业务域重复写校验逻辑；
3. 后续其他页面的映射表会保持相同结构，确保“功能-业务域-文件”的对应关系一致，降低维护成本。

如果需要生成下一个页面的映射表，直接把对应的React文件发给我即可～
